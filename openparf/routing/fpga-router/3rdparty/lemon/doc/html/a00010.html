<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Minimum Cost Flow Problem</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Minimum Cost Flow Problem </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="mcf_def"></a>
Definition (GEQ form)</h1>
<p>The <em>minimum</em> <em>cost</em> <em>flow</em> <em>problem</em> is to find a feasible flow of minimum total cost from a set of supply nodes to a set of demand nodes in a network with capacity constraints (lower and upper bounds) and arc costs <a class="el" href="a00638.html#CITEREF_amo93networkflows">[1]</a>.</p>
<p>Formally, let <img class="formulaInl" alt="$G=(V,A)$" src="form_0.png"/> be a digraph, <img class="formulaInl" alt="$lower: A\rightarrow\mathbf{R}$" src="form_10.png"/>, <img class="formulaInl" alt="$upper: A\rightarrow\mathbf{R}\cup\{+\infty\}$" src="form_11.png"/> denote the lower and upper bounds for the flow values on the arcs, for which <img class="formulaInl" alt="$lower(uv) \leq upper(uv)$" src="form_12.png"/> must hold for all <img class="formulaInl" alt="$uv\in A$" src="form_13.png"/>, <img class="formulaInl" alt="$cost: A\rightarrow\mathbf{R}$" src="form_14.png"/> denotes the cost per unit flow on the arcs and <img class="formulaInl" alt="$sup: V\rightarrow\mathbf{R}$" src="form_15.png"/> denotes the signed supply values of the nodes. If <img class="formulaInl" alt="$sup(u)>0$" src="form_16.png"/>, then <img class="formulaInl" alt="$u$" src="form_17.png"/> is a supply node with <img class="formulaInl" alt="$sup(u)$" src="form_18.png"/> supply, if <img class="formulaInl" alt="$sup(u)<0$" src="form_19.png"/>, then <img class="formulaInl" alt="$u$" src="form_17.png"/> is a demand node with <img class="formulaInl" alt="$-sup(u)$" src="form_20.png"/> demand. A minimum cost flow is an <img class="formulaInl" alt="$f: A\rightarrow\mathbf{R}$" src="form_21.png"/> solution of the following optimization problem.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \min\sum_{uv\in A} f(uv) \cdot cost(uv) \]" src="form_22.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sum_{uv\in A} f(uv) - \sum_{vu\in A} f(vu) \geq sup(u) \quad \forall u\in V \]" src="form_23.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ lower(uv) \leq f(uv) \leq upper(uv) \quad \forall uv\in A \]" src="form_24.png"/>
</p>
<p>The sum of the supply values, i.e. <img class="formulaInl" alt="$\sum_{u\in V} sup(u)$" src="form_25.png"/> must be zero or negative in order to have a feasible solution (since the sum of the expressions on the left-hand side of the inequalities is zero). It means that the total demand must be greater or equal to the total supply and all the supplies have to be carried out from the supply nodes, but there could be demands that are not satisfied. If <img class="formulaInl" alt="$\sum_{u\in V} sup(u)$" src="form_25.png"/> is zero, then all the supply/demand constraints have to be satisfied with equality, i.e. all demands have to be satisfied and all supplies have to be used.</p>
<h1><a class="anchor" id="mcf_algs"></a>
Algorithms</h1>
<p>LEMON contains several algorithms for solving this problem, for more information see <a class="el" href="a00612.html">Minimum Cost Flow Algorithms</a>.</p>
<p>A feasible solution for this problem can be found using <a class="el" href="a00078.html">Circulation</a>.</p>
<h1><a class="anchor" id="mcf_dual"></a>
Dual Solution</h1>
<p>The dual solution of the minimum cost flow problem is represented by node potentials <img class="formulaInl" alt="$\pi: V\rightarrow\mathbf{R}$" src="form_26.png"/>. An <img class="formulaInl" alt="$f: A\rightarrow\mathbf{R}$" src="form_21.png"/> primal feasible solution is optimal if and only if for some <img class="formulaInl" alt="$\pi: V\rightarrow\mathbf{R}$" src="form_26.png"/> node potentials the following <em>complementary</em> <em>slackness</em> optimality conditions hold.</p>
<ul>
<li>For all <img class="formulaInl" alt="$uv\in A$" src="form_13.png"/> arcs:<ul>
<li>if <img class="formulaInl" alt="$cost^\pi(uv)>0$" src="form_27.png"/>, then <img class="formulaInl" alt="$f(uv)=lower(uv)$" src="form_28.png"/>;</li>
<li>if <img class="formulaInl" alt="$lower(uv)<f(uv)<upper(uv)$" src="form_29.png"/>, then <img class="formulaInl" alt="$cost^\pi(uv)=0$" src="form_30.png"/>;</li>
<li>if <img class="formulaInl" alt="$cost^\pi(uv)<0$" src="form_31.png"/>, then <img class="formulaInl" alt="$f(uv)=upper(uv)$" src="form_32.png"/>.</li>
</ul>
</li>
<li>For all <img class="formulaInl" alt="$u\in V$" src="form_33.png"/> nodes:<ul>
<li><img class="formulaInl" alt="$\pi(u)\leq 0$" src="form_34.png"/>;</li>
<li>if <img class="formulaInl" alt="$\sum_{uv\in A} f(uv) - \sum_{vu\in A} f(vu) \neq sup(u)$" src="form_35.png"/>, then <img class="formulaInl" alt="$\pi(u)=0$" src="form_36.png"/>.</li>
</ul>
</li>
</ul>
<p>Here <img class="formulaInl" alt="$cost^\pi(uv)$" src="form_37.png"/> denotes the <em>reduced</em> <em>cost</em> of the arc <img class="formulaInl" alt="$uv\in A$" src="form_13.png"/> with respect to the potential function <img class="formulaInl" alt="$\pi$" src="form_38.png"/>, i.e. </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ cost^\pi(uv) = cost(uv) + \pi(u) - \pi(v).\]" src="form_39.png"/>
</p>
<p>All algorithms provide dual solution (node potentials), as well, if an optimal flow is found.</p>
<h1><a class="anchor" id="mcf_eq"></a>
Equality Form</h1>
<p>The above <a class="el" href="a00010.html#mcf_def">definition</a> is actually more general than the usual formulation of the minimum cost flow problem, in which strict equalities are required in the supply/demand contraints.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \min\sum_{uv\in A} f(uv) \cdot cost(uv) \]" src="form_22.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sum_{uv\in A} f(uv) - \sum_{vu\in A} f(vu) = sup(u) \quad \forall u\in V \]" src="form_40.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ lower(uv) \leq f(uv) \leq upper(uv) \quad \forall uv\in A \]" src="form_24.png"/>
</p>
<p>However, if the sum of the supply values is zero, then these two problems are equivalent. The <a class="el" href="a00612.html">algorithms</a> in LEMON support the general form, so if you need the equality form, you have to ensure this additional contraint manually.</p>
<h1><a class="anchor" id="mcf_leq"></a>
Opposite Inequalites (LEQ Form)</h1>
<p>Another possible definition of the minimum cost flow problem is when there are <em>"less or equal"</em> (LEQ) supply/demand constraints, instead of the <em>"greater or equal"</em> (GEQ) constraints.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \min\sum_{uv\in A} f(uv) \cdot cost(uv) \]" src="form_22.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sum_{uv\in A} f(uv) - \sum_{vu\in A} f(vu) \leq sup(u) \quad \forall u\in V \]" src="form_41.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ lower(uv) \leq f(uv) \leq upper(uv) \quad \forall uv\in A \]" src="form_24.png"/>
</p>
<p>It means that the total demand must be less or equal to the total supply (i.e. <img class="formulaInl" alt="$\sum_{u\in V} sup(u)$" src="form_25.png"/> must be zero or positive) and all the demands have to be satisfied, but there could be supplies that are not carried out from the supply nodes. The equality form is also a special case of this form, of course.</p>
<p>You could easily transform this case to the <a class="el" href="a00010.html#mcf_def">GEQ form</a> of the problem by reversing the direction of the arcs and taking the negative of the supply values (e.g. using <a class="el" href="a00333.html">ReverseDigraph</a> and <a class="el" href="a00274.html">NegMap</a> adaptors). However <a class="el" href="a00276.html">NetworkSimplex</a> algorithm also supports this form directly for the sake of convenience.</p>
<p>Note that the optimality conditions for this supply constraint type are slightly differ from the conditions that are discussed for the GEQ form, namely the potentials have to be non-negative instead of non-positive. An <img class="formulaInl" alt="$f: A\rightarrow\mathbf{R}$" src="form_21.png"/> feasible solution of this problem is optimal if and only if for some <img class="formulaInl" alt="$\pi: V\rightarrow\mathbf{R}$" src="form_26.png"/> node potentials the following conditions hold.</p>
<ul>
<li>For all <img class="formulaInl" alt="$uv\in A$" src="form_13.png"/> arcs:<ul>
<li>if <img class="formulaInl" alt="$cost^\pi(uv)>0$" src="form_27.png"/>, then <img class="formulaInl" alt="$f(uv)=lower(uv)$" src="form_28.png"/>;</li>
<li>if <img class="formulaInl" alt="$lower(uv)<f(uv)<upper(uv)$" src="form_29.png"/>, then <img class="formulaInl" alt="$cost^\pi(uv)=0$" src="form_30.png"/>;</li>
<li>if <img class="formulaInl" alt="$cost^\pi(uv)<0$" src="form_31.png"/>, then <img class="formulaInl" alt="$f(uv)=upper(uv)$" src="form_32.png"/>.</li>
</ul>
</li>
<li>For all <img class="formulaInl" alt="$u\in V$" src="form_33.png"/> nodes:<ul>
<li><img class="formulaInl" alt="$\pi(u)\geq 0$" src="form_42.png"/>;</li>
<li>if <img class="formulaInl" alt="$\sum_{uv\in A} f(uv) - \sum_{vu\in A} f(vu) \neq sup(u)$" src="form_35.png"/>, then <img class="formulaInl" alt="$\pi(u)=0$" src="form_36.png"/>. </li>
</ul>
</li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jul 7 2014 16:39:51 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
